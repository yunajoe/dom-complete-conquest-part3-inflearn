<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì˜ˆì•½ í™•ì¸ & ì˜ìˆ˜ì¦ (ìµœì í™”)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- í°íŠ¸ ìµœì í™” -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- íˆì–´ë¡œ ì´ë¯¸ì§€ ìš°ì„  íŒíŠ¸ -->
    <link
      rel="preload"
      as="image"
      href="https://picsum.photos/1200/600?random=11"
    />

    <style>
      :root {
        --bg: #f6f7fb;
        --panel: #fff;
        --ink: #0f172a;
        --muted: #6b7280;
        --border: #e5e7eb;
        --brand: #2563eb;
      }
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", sans-serif;
        margin: 0;
        background: var(--bg);
        color: var(--ink);
      }
      header {
        padding: 16px 20px;
        background: #fff;
        border-bottom: 1px solid var(--border);
      }
      main {
        max-width: 980px;
        margin: 0 auto;
        padding: 20px;
      }
      .hero {
        display: flex;
        gap: 16px;
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 16px;
      }
      .hero img {
        width: 600px;
        height: auto;
        aspect-ratio: 2/1;
        border-radius: 10px;
        flex: 0 0 auto;
      }
      .info {
        flex: 1;
      }
      .muted {
        color: var(--muted);
        margin-top: 4px;
      }
      .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 12px;
      }
      .btn {
        padding: 10px 14px;
        border: 0;
        border-radius: 8px;
        background: var(--brand);
        color: #fff;
        cursor: pointer;
      }
      .btn[disabled] {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .btn.outline {
        background: #fff;
        color: var(--ink);
        border: 1px solid var(--border);
      }
      .receipt {
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        margin-top: 16px;
      }
      .line {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #f0f2f5;
      }
      .thumbs {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 12px;
        margin-top: 16px;
      }
      .thumbs img {
        display: block;
        width: 100%;
        height: auto;
        aspect-ratio: 2/1;
        border-radius: 8px;
      }
      [data-lazy] {
        content-visibility: auto;
        contain-intrinsic-size: 800px 600px;
      }
      .modal {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.4);
        display: none;
        align-items: center;
        justify-content: center;
      }
      .modal .box {
        background: #fff;
        border-radius: 12px;
        padding: 16px;
        max-width: 90%;
        width: 560px;
      }
      @media print {
        header,
        .actions,
        .thumbs,
        .modal {
          display: none !important;
        }
        body {
          background: #fff;
        }
        .receipt {
          border: 0;
          break-inside: avoid;
        }
        .line strong {
          font-family: ui-monospace, Menlo, monospace;
        }
      }
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
      }
    </style>

    <script defer>
      addEventListener("DOMContentLoaded", () => {
        const $ = (s) => document.querySelector(s);
        const status = $("#status");
        const announce = (msg) => {
          status.textContent = msg;
        };

        const codeEl = $("#code");
        const modal = $("#modal"),
          mTitle = $("#modal-title"),
          mBody = $("#modal-body");
        const buttons = {
          print: $("#btn-print"),
          invoice: $("#btn-invoice"),
          copy: $("#btn-copy"),
          share: $("#btn-share"),
          map: $("#btn-map"),
          cal: $("#btn-calendar"),
          toggle: $("#btn-toggle-items"),
        };
        const items = $("#items");

        const immediateUI = (btn, txt, job) => {
          const prev = btn.textContent;
          btn.disabled = true;
          btn.textContent = txt;
          announce(txt);
          setTimeout(async () => {
            try {
              await job();
            } finally {
              btn.textContent = prev;
              btn.disabled = false;
            }
          }, 0);
        };

        buttons.print.addEventListener("click", () =>
          immediateUI(buttons.print, "PDF ì¤€ë¹„ì¤‘â€¦", async () => {
            window.print();
          })
        );
        buttons.invoice.addEventListener("click", () =>
          immediateUI(buttons.invoice, "ì „ì†¡ì¤‘â€¦", async () => {
            await new Promise((r) => setTimeout(r, 150));
            alert("ì„¸ë¶€ ì˜ìˆ˜ì¦ì„ ì´ë©”ì¼ë¡œ ë°œì†¡í–ˆìŠµë‹ˆë‹¤.");
          })
        );
        buttons.copy.addEventListener("click", async () => {
          try {
            await navigator.clipboard.writeText(codeEl.textContent.trim());
            buttons.copy.textContent = "ë³µì‚¬ë¨!";
            setTimeout(() => (buttons.copy.textContent = "ì˜ˆì•½ë²ˆí˜¸ ë³µì‚¬"), 900);
          } catch {
            alert("ë³µì‚¬ ì‹¤íŒ¨");
          }
        });
        buttons.share.addEventListener("click", async () => {
          const payload = {
            title: "ì˜ˆì•½ ê³µìœ ",
            text: "ë‚´ ì˜ˆì•½ ì •ë³´",
            url: location.href,
          };
          if (navigator.share) {
            try {
              await navigator.share(payload);
            } catch {}
          } else {
            mTitle.textContent = "ê³µìœ ";
            mBody.innerHTML = `<p>ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•´ ê³µìœ í•˜ì„¸ìš”.</p><input value="${location.href}" style="width:100%">`;
            modal.style.display = "flex";
          }
        });
        buttons.map.addEventListener("click", () =>
          immediateUI(buttons.map, "ì§€ë„ ë¡œë”©â€¦", async () => {
            mTitle.textContent = "í˜¸í…” ìœ„ì¹˜";
            mBody.innerHTML = `<iframe src="https://maps.google.com/maps?q=seoul&z=13&output=embed" width="100%" height="320" style="border:0"></iframe>`;
            modal.style.display = "flex";
          })
        );
        buttons.cal.addEventListener("click", () =>
          immediateUI(buttons.cal, "íŒŒì¼ ìƒì„±â€¦", async () => {
            const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:í˜¸í…” ì²´í¬ì¸\nDTSTART:20250903\nDTEND:20250906\nDESCRIPTION:ë¦¬ë²„ì‚¬ì´ë“œ í˜¸í…”\nEND:VEVENT\nEND:VCALENDAR`;
            const blob = new Blob([ics], { type: "text/calendar" });
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "reservation.ics";
            a.click();
            URL.revokeObjectURL(a.href);
          })
        );
        buttons.toggle.addEventListener("click", () => {
          items.hidden = !items.hidden;
          buttons.toggle.textContent = items.hidden
            ? "ì„¸ë¶€ í•­ëª© í¼ì¹˜ê¸°"
            : "ì„¸ë¶€ í•­ëª© ì ‘ê¸°";
        });

        $("#modal-close").addEventListener(
          "click",
          () => (modal.style.display = "none")
        );
        modal.addEventListener("click", (e) => {
          if (e.target === modal) modal.style.display = "none";
        });
        addEventListener("keydown", (e) => {
          if (e.key === "Escape" && modal.style.display === "flex")
            modal.style.display = "none";
        });
      });
    </script>
  </head>
  <body>
    <header>ğŸ¨ ì˜ˆì•½ í™•ì¸ & ì˜ìˆ˜ì¦ (Optimized)</header>
    <main>
      <section class="hero">
        <img
          src="https://picsum.photos/1200/600?random=11"
          srcset="
            https://picsum.photos/600/300?random=11   600w,
            https://picsum.photos/900/450?random=11   900w,
            https://picsum.photos/1200/600?random=11 1200w
          "
          sizes="(max-width: 900px) 100vw, 600px"
          fetchpriority="high"
          decoding="async"
          width="600"
          height="300"
          alt="í˜¸í…” ì™¸ê´€"
        />
        <div class="info">
          <h1>ë¦¬ë²„ì‚¬ì´ë“œ í˜¸í…”</h1>
          <p class="muted">
            ì²´í¬ì¸ 2025-09-03 Â· ì²´í¬ì•„ì›ƒ 2025-09-06 Â· ì˜ˆì•½ë²ˆí˜¸
            <code id="code">RSV-8421</code>
          </p>
          <div class="actions">
            <button class="btn" id="btn-print">ì¸ì‡„ / PDF ì €ì¥</button>
            <button class="btn outline" id="btn-invoice">
              ì„¸ë¶€ ì˜ìˆ˜ì¦ ë³´ê¸°
            </button>
            <button class="btn outline" id="btn-copy">ì˜ˆì•½ë²ˆí˜¸ ë³µì‚¬</button>
            <button class="btn outline" id="btn-share">ê³µìœ </button>
            <button class="btn outline" id="btn-map">ì§€ë„ ë³´ê¸°</button>
            <button class="btn outline" id="btn-calendar">ìº˜ë¦°ë” ì¶”ê°€</button>
          </div>
        </div>
      </section>

      <section class="receipt" id="receipt" data-lazy>
        <h3>ìš”ê¸ˆ ë‚´ì—­</h3>
        <div class="line">
          <span>ê°ì‹¤ ìš”ê¸ˆ(3ë°•)</span><strong>â‚©420,000</strong>
        </div>
        <div class="line"><span>ì„¸ê¸ˆ/ë´‰ì‚¬ë£Œ</span><strong>â‚©42,000</strong></div>
        <div class="line"><span>ë¦¬ì¡°íŠ¸ í”¼</span><strong>â‚©18,000</strong></div>
        <div class="line">
          <span><strong>í•©ê³„</strong></span
          ><strong>â‚©480,000</strong>
        </div>
        <button class="btn outline" id="btn-toggle-items">
          ì„¸ë¶€ í•­ëª© í¼ì¹˜ê¸°
        </button>
        <div id="items" hidden>
          <div class="line"><span>ë£¸ì„œë¹„ìŠ¤</span><strong>â‚©28,000</strong></div>
          <div class="line"><span>ë¯¸ë‹ˆë°”</span><strong>â‚©9,000</strong></div>
        </div>
      </section>

      <section class="thumbs">
        <img
          loading="lazy"
          decoding="async"
          src="https://picsum.photos/800/400?random=21"
          srcset="
            https://picsum.photos/400/200?random=21 400w,
            https://picsum.photos/800/400?random=21 800w
          "
          sizes="(max-width: 700px) 100vw, 400px"
          width="400"
          height="200"
          alt="ê°ì‹¤1"
        />
        <!-- ë‹¤ë¥¸ ì¸ë„¤ì¼ë„ ë™ì¼ íŒ¨í„´ -->
      </section>
    </main>

    <div
      class="modal"
      id="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      <div class="box">
        <h3 id="modal-title">ëª¨ë‹¬</h3>
        <div id="modal-body">ë‚´ìš©</div>
        <button class="btn outline" id="modal-close">ë‹«ê¸°</button>
      </div>
    </div>
    <div
      id="status"
      class="sr-only"
      aria-live="polite"
      aria-atomic="true"
    ></div>
  </body>
</html>
